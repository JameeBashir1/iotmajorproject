<!-- Jamee Bashir -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOT Major Project</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400&family=Kalam:wght@700&family=Roboto+Mono:wght@200&display=swap" rel="stylesheet">
</head>
<body onload="initClock()">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        <strong>Message:</strong>{{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"></button>
        <span aria-hidden="true">&times;</span>
    </div>
    {% endfor %}
    {% if user.is_authenticated %}
    <h3>Hello {{ name }}</h3>
    <h4>You're In . Welcome to the Project</h4>
    <h1>Website Will be Shown Here</h1>
    <button type="submit"><a href="/signout">signout</a></button>

    {% else %}
    <!-- <div class="notAuth">
        <div id="greetingScreen">
            <h1>Welcome To IOT Major Project Webiste</h1>
            <p class="accessDir">To access the website , Please Signup / Signin</p>
        </div>

        <div id="auth">
            <button type="submit" class="btn btn-outline-dark"><a href="/signup">Sign-Up</a></button>
            <button type="submit" class="btn btn-outline-dark"><a href="/signin">Sign-In</a></button>
        </div>
    </div> -->
    <div id="mainDiv">
        <div id="header">
            <!-- Header Starts Here -->
            
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <a style="font-family: 'kalam',cursive; font-size: 400%;" class="navbar-brand" href="#">AHM LAB</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div style="position: relative;left: 100%;" id="navbarRightPart" class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                    <a  class="nav-link" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="#">About</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="#">Data</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Logout</a>
                    </li>    
                </ul>
                </div>
            </nav>
            <!-- Header Ends Here -->
        </div>

        <div id="body">
            <!-- Body Starts Here -->
            <h1 id="bodyHeading" style="font-family: 'Roboto Mono', monospace;">AiOT BASED CONDITION MONITORING</h1>
            <h3 class="bodyHeadingDiscription">Fault Prediction on Rotating Machines</h3><br><br>

            <div id="cards">
                <div id="card1" style="z-index: 1; position: relative;left: -4.5%;">
                    <!-- Card 1 Starts Here -->
                    <div class="card" style="width: 20rem; height: 20rem;">
                        <h1 style="padding-left: 17%;position: relative; top: 5%;">Machine 1</h1>
                        <!-- <img src="{% static grap.png %}" alt="graph-img"/> -->
                        <div id="graph" style=" z-index: 0; position: relative;top: 8%;">
                            <!-- Graph Image Div -->
                            <img src="{% static 'graph.png' %}" style="width: 19rem; z-index: -10;" alt="" srcset="">
                        </div>
                        
                    </div>
                    <!-- Card 1 Ends Here -->
                </div>

                <div id="card2">
                    <!-- Card 2 Starts Here -->
                    <div class="card" style="width: 27rem; height: 20rem;">
                        <h1 style="padding: 2%;">Fault Prediction (M-1)</h1>
                        <h3 style="position: relative;left: 7%;top: 3%;">Machine Health Goes Here</h3>
                        <h3 style="position: relative; top: 15%;left: 7%;">Machine Status : </h3>
                            <!-- Machine On Off Button Starts Here -->   
                        <div class="onoffSwitch"style=" cursor: pointer; position: relative;left: 60%; top: 4%;">
                            <span id="machineStatusOnOffText" style="color: white;
                                padding: 8px;background-color: {{color}}; border-radius: 25px;" class="label success">{{mos}}</span>
                            <button onclick="togg()" id="btnTextTurnOnTurnOff" style="position:relative; top:-10%;left:3%; z-index: 20;" type="button" class="btn btn-outline-primary" name="machineBtn">{{bt}}</button>
                        </div>
                        <script>
                            x=document.getElementById("machineStatusOnOffText");
                            y=document.getElementById("btnTextTurnOnTurnOff");
                            // console.log(x.innerHTML);
                            function togg(){
                                if(x.innerHTML=="ON"){
                                    x.innerHTML="OFF";
                                    y.innerHTML="Turn ON";
                                    x.style.backgroundColor = "black";
                                }
                                else{
                                    x.innerHTML="ON";
                                    y.innerHTML="Turn OFF";
                                    x.style.backgroundColor="#04AA6D";
                                }
                            }
                        </script> 
                            <!-- Machine on Off BUtton Ends Here -->
                        <!--digital clock start-->
                        <div style="position: relative; left: 8%;top: 10%;" class="datetime">
                            <div class="date">
                            <span id="dayname">Day</span>,
                            <span id="month">Month</span>
                            <span id="daynum">00</span>,
                            <span id="year">Year</span>
                            </div>
                            <div class="time">
                            <span id="hour">00</span>:
                            <span id="minutes">00</span>:
                            <span id="seconds">00</span>
                            <span id="period">AM</span>
                            </div>
                        </div>
                        <!--digital clock end-->
                    
                        <script type="text/javascript">
                        function updateClock(){
                            var now = new Date();
                            var dname = now.getDay(),
                                mo = now.getMonth(),
                                dnum = now.getDate(),
                                yr = now.getFullYear(),
                                hou = now.getHours(),
                                min = now.getMinutes(),
                                sec = now.getSeconds(),
                                pe = "AM";
                    
                                if(hou >= 12){
                                pe = "PM";
                                }
                                if(hou == 0){
                                hou = 12;
                                }
                                if(hou > 12){
                                hou = hou - 12;
                                }
                    
                                Number.prototype.pad = function(digits){
                                for(var n = this.toString(); n.length < digits; n = 0 + n);
                                return n;
                                }
                    
                                var months = ["January", "February", "March", "April", "May", "June", "July", "Augest", "September", "October", "November", "December"];
                                var week = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                                var ids = ["dayname", "month", "daynum", "year", "hour", "minutes", "seconds", "period"];
                                var values = [week[dname], months[mo], dnum.pad(2), yr, hou.pad(2), min.pad(2), sec.pad(2), pe];
                                for(var i = 0; i < ids.length; i++)
                                document.getElementById(ids[i]).firstChild.nodeValue = values[i];
                        }
                    
                        function initClock(){
                            updateClock();
                            window.setInterval("updateClock()", 1);
                        }
                        </script>
                    </div>
                    <!-- Card 2 Ends Here -->
                </div>

                <div id="card3">
                    <!-- Card 3 Starts Here -->
                    <div  class="card" style="width: 35rem; height: 20rem; font-size: large;">
                        <h1 style="padding: 2%;">Monitoring Parameters(M-1)</h1>
                        <div id="level-1-col1" style="position: relative;top: 10%;">
                            <ul>
                                <li id>Gyro_x : <span id="field1_value">0.0000</span></li>
                                <li>Min : {{ min }}</li>
                                <li>ST-Dev : {{ std }}</li>
                                <li>Skewness : {{ skw }}</li>
                                <li>Energy : NULL</li>
                            </ul>
                        </div>
                        <!-- Script for li values -->
                        <script>
                            setInterval(function() {
                                // Fetch data from the API
                                fetch("https://api.thingspeak.com/channels/2002930/feeds.json?api_key=HO1K3PSOT931SJ1B&results=2")
                                .then(response => response.json())
                                .then(data => {
                                    let field1_value = data["feeds"][0]["field1"];
                                    console.log(field1_value);
                                    // Update the page with the new data
                                    document.getElementById("field1_value").innerHTML = field1_value;
                                });
                            }, 1000); // fetch data every 1 seconds
                        </script>
                        
                        <div id="level-2-row2">
                            <ul>
                                <li>RMS : {{ rms }}</li>
                                <li>MAX : {{ max }}</li>
                                <li>Kutosis : {{ Kutosis }}</li>
                                <li>Peak Value : NULL</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Card 3 Ends Here -->
                </div>

            </div>
            <br><br>
            <div id="camera">
                <!-- Card Camera Starts Here -->
                <div class="card" style="width: 35rem; height: 30rem; position: relative; left: -4.5%;">
                    <h1 style="padding-left: 10%;">Live Camera Machine 1</h1>
                    <video autoplay="true" id="videoElement" style="width: 40rem; height: 25rem; position: relative; left: -7%; top: 2%;">

                    </video>
                </div>
                <script>
                    let video= document.querySelector("#videoElement");
                    if(navigator.mediaDevices.getUserMedia){
                        navigator.mediaDevices.getUserMedia({video:true})
                        .then(function(stream){
                            video.srcObject=stream;
                        })
                        .catch(function(error){
                            console.log("Something went wrong !")
                        })
                    }
                    else{
                        console.log("Not Supported Media")
                    }
                </script>
                <!-- Card Camera Ends Here -->
            </div>
            <!-- Body Ends Here -->
        </div>
    <!-- Site footer -->
    <footer style="position: absolute; top: 153%;left: 8%; background-color: white;" class="site-footer">
        <!-- Footer Starts Here -->
        <div class="container">
          <div class="row">
            <div class="col-sm-12 col-md-6">
              <h6 style="color: black;">About Us</h6>
              <p>CART, (formerly known as ITMMEC) has been established in May 2019 with a vision to promote interdisciplinary research in Electric Vehicles (EV) and related areas.</p>
            </div>
  
            <div class="col-xs-6 col-md-3">
              <h6 style="color: black;">Information</h6>
              <ul class="footer-links">
                <li>IIT Campus, Hauz Khas</li>
                <li>New Delhi, Delhi 110016</li>
                <li>Phone: 011-2659-1281</li>
                <li>Email: hodcart@admin.iitd.ac.in</li>
              </ul>
            </div>
  
            <div class="col-xs-6 col-md-3">
              <h6 style="color: black;">Quick Links</h6>
              <ul class="footer-links">
                <li><a href="#">About Us</a></li>
                <li><a href="#">Faculty</a></li>
                <li><a href="#">About Us</a></li>
              </ul>
            </div>
          </div>
          <hr>
        </div>
        <div class="container">
          <div class="row">
            <div class="col-md-8 col-sm-6 col-xs-12">
              <p class="copyright-text">Copyright &copy; 2022 All Rights Reserved by 
           <a href="https://cart.iitd.ac.in/">CART , IIT Delhi</a>.
              </p>
            </div>
          </div>
        </div>
        <!-- Footer Ends Here -->
    </footer>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    {% endif %}
    </body>
</html>